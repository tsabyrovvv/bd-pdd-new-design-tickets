<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–∏–ª–µ—Ç ‚Ññ1 - –≠–∫–∑–∞–º–µ–Ω –ü–î–î –ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω–∞ 2025</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    
    <!-- Google Fonts - Montserrat -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Montserrat', 'system-ui', 'sans-serif']
                    },
                    animation: {
                        'wave': 'wave 20s linear infinite',
                        'fadeIn': 'fadeIn 0.3s ease',
                        'pulse-slow': 'pulse 3s ease-in-out infinite',
                        'shake': 'shake 0.5s ease-in-out'
                    },
                    keyframes: {
                        wave: {
                            '0%': { transform: 'translateX(0) translateY(0)' },
                            '100%': { transform: 'translateX(-50px) translateY(-50px)' }
                        },
                        fadeIn: {
                            'from': { opacity: '0', transform: 'translateY(-10px)' },
                            'to': { opacity: '1', transform: 'translateY(0)' }
                        },
                        shake: {
                            '0%, 100%': { transform: 'translateX(0)' },
                            '10%, 30%, 50%, 70%, 90%': { transform: 'translateX(-5px)' },
                            '20%, 40%, 60%, 80%': { transform: 'translateX(5px)' }
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        .wave-bg {
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
        }
        
        .loading-spinner {
            border: 3px solid rgba(59, 130, 246, 0.3);
            border-radius: 50%;
            border-top: 3px solid #3b82f6;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-blue-600 font-sans text-slate-800">
    
    <!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω -->
    <div class="fixed inset-0 -z-10 opacity-5">
        <div class="absolute inset-0 wave-bg animate-wave"></div>
    </div>

    <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
    <div id="loader" class="fixed inset-0 bg-gradient-to-br from-blue-900 via-blue-800 to-blue-600 z-50 flex items-center justify-center">
        <div class="text-center">
            <div class="loading-spinner mx-auto mb-4"></div>
            <div class="text-white text-xl font-semibold">–ó–∞–≥—Ä—É–∑–∫–∞ –±–∏–ª–µ—Ç–∞...</div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-5 max-w-4xl" id="main-content" style="display: none;">
        
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —ç–∫–∑–∞–º–µ–Ω–∞ -->
        <div class="bg-white/95 backdrop-blur-xl rounded-3xl p-6 mb-6 border border-white/30 shadow-xl">
            <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4">
                <div class="flex items-center gap-3">
                    <div class="w-12 h-12 bg-gradient-to-r from-blue-600 to-blue-700 rounded-full flex items-center justify-center text-white text-xl">
                        <i class="bi bi-car-front"></i>
                    </div>
                    <h1 class="text-2xl lg:text-3xl font-bold text-blue-900" id="exam-title">–ë–∏–ª–µ—Ç ‚Ññ1</h1>
                </div>
                
                <div class="flex flex-wrap gap-4 text-sm lg:text-base">
                    <div class="flex items-center gap-2 bg-blue-50 px-4 py-2 rounded-xl border-2 border-blue-200">
                        <i class="bi bi-clock text-blue-600"></i>
                        <span class="font-semibold text-blue-900" id="timer">25:00</span>
                    </div>
                    <div class="flex items-center gap-2 bg-blue-50 px-4 py-2 rounded-xl border-2 border-blue-200">
                        <i class="bi bi-list-ol text-blue-600"></i>
                        <span class="font-semibold text-blue-900" id="question-counter">1 –∏–∑ 20</span>
                    </div>
                    <div class="flex items-center gap-2 bg-red-50 px-4 py-2 rounded-xl border-2 border-red-200">
                        <i class="bi bi-x-circle text-red-600"></i>
                        <span class="font-semibold text-red-900" id="errors-counter">0 –æ—à–∏–±–æ–∫</span>
                    </div>
                </div>
            </div>
            
            <div class="w-full bg-blue-100 rounded-full h-3 mt-4 overflow-hidden">
                <div class="bg-gradient-to-r from-blue-600 to-blue-700 h-3 rounded-full transition-all duration-500 ease-out" 
                     style="width: 5%" id="progress-bar"></div>
            </div>
        </div>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º -->
        <div class="bg-white/95 backdrop-blur-xl rounded-2xl p-5 mb-6 border border-white/30 shadow-lg">
            <div class="grid grid-cols-10 gap-2 lg:gap-3" id="questions-nav">
                <!-- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è JS -->
            </div>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –≤–æ–ø—Ä–æ—Å–∞ -->
        <div class="bg-white/95 backdrop-blur-xl rounded-3xl p-6 lg:p-8 mb-6 border border-white/30 shadow-xl relative overflow-hidden">
            <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-600 via-blue-700 to-blue-600"></div>
            
            <img id="question-image" class="w-full max-w-md mx-auto rounded-2xl shadow-lg mb-6 hidden" alt="">
            
            <div class="text-xl lg:text-2xl leading-relaxed text-slate-800 font-semibold mb-8" id="question-text">
                <!-- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ JSON -->
            </div>

            <div class="space-y-4" id="answers-container">
                <!-- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è JS -->
            </div>

            <div class="mt-6 p-5 bg-amber-50 border-2 border-amber-200 rounded-2xl hidden animate-fadeIn" id="hint-section">
                <div class="flex items-center gap-2 text-amber-800 font-bold mb-3">
                    <i class="bi bi-lightbulb text-xl"></i>
                    <span>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ</span>
                </div>
                <div class="text-amber-900 leading-relaxed" id="hint-text"></div>
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <div class="flex flex-wrap justify-center gap-3 mb-6">
            <button onclick="showMenu()" 
                    class="flex items-center gap-2 bg-slate-600 hover:bg-slate-700 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 hover:scale-105 shadow-lg">
                <i class="bi bi-grid-3x3-gap"></i> –ú–µ–Ω—é
            </button>
            <button onclick="previousQuestion()" id="prev-btn"
                    class="flex items-center gap-2 bg-slate-600 hover:bg-slate-700 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 hover:scale-105 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
                <i class="bi bi-arrow-left"></i> –ù–∞–∑–∞–¥
            </button>
            <button onclick="nextQuestion()" id="next-btn"
                    class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 hover:scale-105 shadow-lg">
                –î–∞–ª–µ–µ <i class="bi bi-arrow-right"></i>
            </button>
            <button onclick="tryFinishExam()" id="finish-btn"
                    class="flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 hover:scale-105 shadow-lg">
                <i class="bi bi-flag-fill"></i> –ó–∞–≤–µ—Ä—à–∏—Ç—å
            </button>
        </div>

        <!-- –§—É—Ç–µ—Ä -->
        <div class="bg-white/90 backdrop-blur-xl rounded-2xl p-5 text-center border border-white/30 shadow-lg">
            <div class="text-slate-600">
                <strong class="text-blue-900">–ê–≤—Ç–æ—à–∫–æ–ª–∞ "Best Driver"</strong><br>
                –≠–∫–∑–∞–º–µ–Ω –ü–î–î –ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω–∞ 2025 ‚Ä¢ –í–æ–ø—Ä–æ—Å—ã: <strong class="text-blue-900">0505123553</strong>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
    <div id="result-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-3xl p-8 max-w-lg w-full text-center shadow-2xl transform scale-95 transition-transform duration-300">
            <div class="text-4xl mb-4" id="result-icon">üéâ</div>
            <div class="text-3xl font-bold mb-6 text-blue-900" id="result-title">–≠–∫–∑–∞–º–µ–Ω –∑–∞–≤–µ—Ä—à–µ–Ω!</div>
            <div class="text-lg mb-6 text-slate-600" id="result-message">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã —É—Å–ø–µ—à–Ω–æ —Å–¥–∞–ª–∏ —ç–∫–∑–∞–º–µ–Ω.</div>
            
            <div class="grid grid-cols-4 gap-4 mb-6">
                <div class="bg-slate-50 rounded-xl p-4">
                    <div class="text-2xl font-bold text-green-600" id="correct-answers">0</div>
                    <div class="text-sm text-slate-600">–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö</div>
                </div>
                <div class="bg-slate-50 rounded-xl p-4">
                    <div class="text-2xl font-bold text-red-600" id="wrong-answers">0</div>
                    <div class="text-sm text-slate-600">–û—à–∏–±–æ–∫</div>
                </div>
                <div class="bg-slate-50 rounded-xl p-4">
                    <div class="text-2xl font-bold text-blue-600" id="time-spent">0:00</div>
                    <div class="text-sm text-slate-600">–í—Ä–µ–º—è</div>
                </div>
                <div class="bg-slate-50 rounded-xl p-4">
                    <div class="text-2xl font-bold text-purple-600" id="score-percentage">0%</div>
                    <div class="text-sm text-slate-600">–†–µ–∑—É–ª—å—Ç–∞—Ç</div>
                </div>
            </div>
            
            <div class="flex gap-3 justify-center">
                <button onclick="restartExam()" 
                        class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold transition-all">
                    <i class="bi bi-arrow-clockwise"></i> –ü–µ—Ä–µ—Å–¥–∞—Ç—å
                </button>
                <button onclick="showMenu()" 
                        class="flex items-center gap-2 bg-slate-600 hover:bg-slate-700 text-white px-6 py-3 rounded-xl font-semibold transition-all">
                    <i class="bi bi-grid-3x3-gap"></i> –ö –±–∏–ª–µ—Ç–∞–º
                </button>
            </div>

            <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è -->
            <div id="warning-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
                <div class="bg-white rounded-3xl p-8 max-w-md w-full text-center shadow-2xl transform scale-95 transition-transform duration-300">
                    <div class="text-4xl mb-4">‚ö†Ô∏è</div>
                    <div class="text-2xl font-bold mb-4 text-red-600">–ù–µ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–µ–Ω—ã!</div>
                    <div class="text-lg mb-6 text-slate-600" id="warning-message">
                        –í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ —Ç–æ–ª—å–∫–æ –Ω–∞ <span id="answered-count">0</span> –∏–∑ <span id="total-count">20</span> –≤–æ–ø—Ä–æ—Å–æ–≤.
                    </div>
                    <div class="text-sm mb-6 text-slate-500">
                        –ó–∞–≤–µ—Ä—à–∏—Ç—å —ç–∫–∑–∞–º–µ–Ω –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã.
                    </div>
                    
                    <div class="flex gap-3 justify-center">
                        <button onclick="closeWarningModal()" 
                                class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold transition-all">
                            <i class="bi bi-arrow-left"></i> –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
                        </button>
                        <button onclick="forceFinishExam()" 
                                class="flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-xl font-semibold transition-all">
                            <i class="bi bi-flag-fill"></i> –ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let examData = null;
        let currentQuestion = 0;
        let userAnswers = {};
        let timeLeft = 1500; // 25 –º–∏–Ω—É—Ç
        let timerInterval = null;
        let isAnswered = false;
        let totalErrors = 0;
        let isExamFinished = false;

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON —Ñ–∞–π–ª–∞
        async function loadExamData() {
            try {
                // –ü–æ–ª—É—á–∞–µ–º –Ω–æ–º–µ—Ä –±–∏–ª–µ—Ç–∞ –∏–∑ URL –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                const urlParams = new URLSearchParams(window.location.search);
                const ticketNumber = urlParams.get('ticket') || getTicketFromPath() || '1';
                
                const response = await fetch(`data/ticket_${ticketNumber}.json`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                throw error;
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –±–∏–ª–µ—Ç–∞ –∏–∑ –ø—É—Ç–∏ URL
        function getTicketFromPath() {
            const path = window.location.pathname;
            const match = path.match(/(\d+)\.html?$/);
            return match ? match[1] : null;
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–∫–∑–∞–º–µ–Ω–∞
        async function initExam() {
            try {
                examData = await loadExamData();
                timeLeft = examData.timeLimit;
                
                document.getElementById('exam-title').textContent = `–ë–∏–ª–µ—Ç ‚Ññ${examData.ticketNumber}`;
                document.getElementById('loader').style.display = 'none';
                document.getElementById('main-content').style.display = 'block';
                
                createQuestionsNav();
                displayQuestion(0);
                startTimer();
                setupEventListeners();
                updateNavigationButtons();
                updateFinishButton();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                document.getElementById('loader').innerHTML = `
                    <div class="text-center text-white">
                        <i class="bi bi-exclamation-triangle text-4xl mb-4"></i>
                        <div class="text-xl font-semibold mb-2">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–ª–µ—Ç–∞</div>
                        <div class="text-sm mb-4">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ —ç–∫–∑–∞–º–µ–Ω–∞</div>
                        <div class="text-xs mb-4 opacity-75">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞ data/ticket_${getTicketFromPath() || '1'}.json</div>
                        <button onclick="location.reload()" class="bg-white text-blue-900 px-6 py-2 rounded-lg font-semibold hover:bg-blue-50 transition-colors">
                            –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É
                        </button>
                        <a href="index.html" class="block mt-2 text-white/75 hover:text-white text-sm">
                            ‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—ã–±–æ—Ä—É –±–∏–ª–µ—Ç–æ–≤
                        </a>
                    </div>
                `;
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º
        function createQuestionsNav() {
            const nav = document.getElementById('questions-nav');
            nav.innerHTML = '';
            
            for (let i = 0; i < examData.questions.length; i++) {
                const btn = document.createElement('button');
                btn.className = `w-10 h-10 rounded-xl font-bold text-sm transition-all duration-300 hover:scale-110 ${
                    i === 0 ? 'bg-blue-600 text-white border-2 border-blue-600' : 
                    'bg-white border-2 border-blue-200 text-slate-600 hover:border-blue-400'
                }`;
                btn.textContent = i + 1;
                btn.onclick = () => goToQuestion(i);
                btn.id = `question-nav-${i}`;
                nav.appendChild(btn);
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞
        function displayQuestion(index) {
            if (isExamFinished) return;
            
            currentQuestion = index;
            isAnswered = userAnswers.hasOwnProperty(index);
            const question = examData.questions[index];
            
            document.getElementById('question-text').textContent = question.text;
            document.getElementById('question-counter').textContent = `${index + 1} –∏–∑ ${examData.questions.length}`;
            
            // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            const img = document.getElementById('question-image');
            if (question.image) {
                img.src = question.image;
                img.classList.remove('hidden');
            } else {
                img.classList.add('hidden');
            }
            
            // –û—Ç–≤–µ—Ç—ã
            const container = document.getElementById('answers-container');
            container.innerHTML = '';
            
            question.answers.forEach((answer, i) => {
                const div = document.createElement('div');
                div.className = `p-5 rounded-2xl border-3 cursor-pointer transition-all duration-300 hover:scale-[1.02] hover:shadow-lg ${getAnswerClass(index, i)}`;
                
                div.innerHTML = `
                    <div class="flex items-start gap-4">
                        <div class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-sm flex-shrink-0">
                            ${i + 1}
                        </div>
                        <div class="text-slate-700 font-medium leading-relaxed">${answer}</div>
                    </div>
                `;
                
                if (!isAnswered) {
                    div.onclick = () => selectAnswer(i);
                }
                
                container.appendChild(div);
            });
            
            document.getElementById('hint-text').textContent = question.hint;
            updateQuestionsNav();
            updateProgress();
            updateNavigationButtons();
            updateFinishButton();
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É –µ—Å–ª–∏ —É–∂–µ –æ—Ç–≤–µ—á–∞–ª–∏
            if (isAnswered) {
                document.getElementById('hint-section').classList.remove('hidden');
            } else {
                document.getElementById('hint-section').classList.add('hidden');
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ CSS –∫–ª–∞—Å—Å–∞ –¥–ª—è –æ—Ç–≤–µ—Ç–∞
        function getAnswerClass(questionIndex, answerIndex) {
            if (!userAnswers.hasOwnProperty(questionIndex)) {
                return 'bg-white border-blue-200 hover:border-blue-400';
            }
            
            const question = examData.questions[questionIndex];
            const userAnswer = userAnswers[questionIndex];
            
            if (answerIndex === userAnswer) {
                if (answerIndex === question.correct) {
                    return 'bg-green-50 border-green-500';
                } else {
                    return 'bg-red-50 border-red-500';
                }
            } else if (answerIndex === question.correct) {
                return 'bg-green-50 border-green-500';
            } else {
                return 'bg-white border-blue-200';
            }
        }

        // –í—ã–±–æ—Ä –æ—Ç–≤–µ—Ç–∞
        // function selectAnswer(answerIndex) {
        //     if (isAnswered || isExamFinished) return;
            
        //     const question = examData.questions[currentQuestion];
        //     userAnswers[currentQuestion] = answerIndex;
        //     isAnswered = true;
            
        //     // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞
        //     if (answerIndex !== question.correct) {
        //         totalErrors++;
        //         updateErrorsCounter();
                
        //         // –ï—Å–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫, –∑–∞–≤–µ—Ä—à–∞–µ–º —ç–∫–∑–∞–º–µ–Ω
        //         if (totalErrors > examData.maxErrors) {
        //             setTimeout(() => {
        //                 forceFinishExam();
        //             }, 2000);
        //         }
        //     }
            
        //     // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
        //     displayQuestion(currentQuestion);
        //     updateFinishButton();
            
        //     // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
        //     setTimeout(() => {
        //         document.getElementById('hint-section').classList.remove('hidden');
        //         document.getElementById('hint-section').classList.add('animate-fadeIn');
        //     }, 500);
        // }

        // –í—ã–±–æ—Ä –æ—Ç–≤–µ—Ç–∞
        function selectAnswer(answerIndex) {
            if (isAnswered || isExamFinished) return;
            
            const question = examData.questions[currentQuestion];
            userAnswers[currentQuestion] = answerIndex;
            isAnswered = true;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞
            if (answerIndex !== question.correct) {
                totalErrors++;
                updateErrorsCounter();
                
                // –ï—Å–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
                if (totalErrors > examData.maxErrors) {
                    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ —Å–Ω–∞—á–∞–ª–∞
                    displayQuestion(currentQuestion);
                    updateFinishButton();
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
                    setTimeout(() => {
                        document.getElementById('hint-section').classList.remove('hidden');
                        document.getElementById('hint-section').classList.add('animate-fadeIn');
                    }, 500);
                    
                    // –ó–∞–≤–µ—Ä—à–∞–µ–º —ç–∫–∑–∞–º–µ–Ω —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        forceFinishExam();
                    }, 3000);
                    return;
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
            displayQuestion(currentQuestion);
            updateFinishButton();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
            setTimeout(() => {
                document.getElementById('hint-section').classList.remove('hidden');
                document.getElementById('hint-section').classList.add('animate-fadeIn');
            }, 500);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É
            setTimeout(() => {
                if (currentQuestion < examData.questions.length - 1) {
                    displayQuestion(currentQuestion + 1);
                } else {
                    // –ï—Å–ª–∏ —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–µ—Å–ª–∏ –≤—Å–µ –æ—Ç–≤–µ—á–µ–Ω—ã)
                    const answeredCount = Object.keys(userAnswers).length;
                    if (answeredCount === examData.questions.length) {
                        finishExam();
                    }
                }
            }, 1500);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –æ—à–∏–±–æ–∫
        function updateErrorsCounter() {
            const counter = document.getElementById('errors-counter');
            counter.textContent = `${totalErrors} ${getErrorsWord(totalErrors)}`;
            
            if (totalErrors > examData.maxErrors) {
                counter.className = counter.className.replace('border-red-200 bg-red-50', 'border-red-500 bg-red-100 animate-shake');
            }
        }

        function getErrorsWord(count) {
            if (count === 1) return '–æ—à–∏–±–∫–∞';
            if (count >= 2 && count <= 4) return '–æ—à–∏–±–∫–∏';
            return '–æ—à–∏–±–æ–∫';
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function updateQuestionsNav() {
            document.querySelectorAll('[id^="question-nav-"]').forEach((btn, index) => {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –∏ —Ç–µ–∫—Å—Ç
                const baseClasses = 'w-10 h-10 rounded-xl font-bold text-sm transition-all duration-300 hover:scale-110';
                
                if (index === currentQuestion) {
                    btn.className = `${baseClasses} bg-blue-600 text-white border-2 border-blue-600`;
                } else if (userAnswers.hasOwnProperty(index)) {
                    const question = examData.questions[index];
                    if (userAnswers[index] === question.correct) {
                        btn.className = `${baseClasses} bg-green-500 text-white border-2 border-green-500`;
                    } else {
                        btn.className = `${baseClasses} bg-red-500 text-white border-2 border-red-500`;
                    }
                } else {
                    btn.className = `${baseClasses} bg-white border-2 border-blue-200 text-slate-600 hover:border-blue-400`;
                }
                
                // –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ —Ç–µ–∫—Å—Ç –Ω–µ –ø–æ—Ç–µ—Ä—è–ª—Å—è
                btn.textContent = index + 1;
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            prevBtn.disabled = currentQuestion === 0;
            if (prevBtn.disabled) {
                prevBtn.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                prevBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
            
            if (currentQuestion === examData.questions.length - 1) {
                nextBtn.innerHTML = '<i class="bi bi-flag-fill"></i> –ó–∞–≤–µ—Ä—à–∏—Ç—å';
                nextBtn.onclick = finishExam;
            } else {
                nextBtn.innerHTML = '–î–∞–ª–µ–µ <i class="bi bi-arrow-right"></i>';
                nextBtn.onclick = nextQuestion;
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        function updateProgress() {
            const answeredCount = Object.keys(userAnswers).length;
            const progress = (answeredCount / examData.questions.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
        }

        // –¢–∞–π–º–µ—Ä
        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                
                const timerElement = document.getElementById('timer');
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // –ò–∑–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç –ø—Ä–∏ –º–∞–ª–æ–º –≤—Ä–µ–º–µ–Ω–∏
                if (timeLeft <= 300) { // 5 –º–∏–Ω—É—Ç
                    timerElement.parentElement.className = timerElement.parentElement.className.replace('bg-blue-50 border-blue-200', 'bg-red-50 border-red-200');
                    timerElement.className = timerElement.className.replace('text-blue-900', 'text-red-900');
                }
                
                if (timeLeft <= 0) {
                    finishExam();
                }
            }, 1000);
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è
        function nextQuestion() {
            if (currentQuestion < examData.questions.length - 1) {
                displayQuestion(currentQuestion + 1);
            } else {
                finishExam();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                displayQuestion(currentQuestion - 1);
            }
        }

        function goToQuestion(index) {
            displayQuestion(index);
        }

        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω–∞
        function finishExam() {
            if (isExamFinished) return;
            
            isExamFinished = true;
            clearInterval(timerInterval);
            
            const answeredCount = Object.keys(userAnswers).length;
            const correctCount = Object.keys(userAnswers).filter(key => 
                userAnswers[key] === examData.questions[key].correct
            ).length;
            
            const wrongCount = answeredCount - correctCount;
            const timeSpent = examData.timeLimit - timeLeft;
            const minutes = Math.floor(timeSpent / 60);
            const seconds = timeSpent % 60;
            const percentage = Math.round((correctCount / examData.questions.length) * 100);
            const passed = wrongCount <= examData.maxErrors;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            const modal = document.getElementById('result-modal');
            const icon = document.getElementById('result-icon');
            const title = document.getElementById('result-title');
            const message = document.getElementById('result-message');
            
            if (passed) {
                icon.textContent = 'üéâ';
                title.innerHTML = '<i class="bi bi-check-circle-fill text-green-600"></i> –≠–∫–∑–∞–º–µ–Ω —Å–¥–∞–Ω!';
                title.className = 'text-3xl font-bold mb-6 text-green-600';
                message.textContent = '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã —É—Å–ø–µ—à–Ω–æ —Å–¥–∞–ª–∏ —ç–∫–∑–∞–º–µ–Ω –ø–æ –ü–î–î.';
            } else {
                icon.textContent = 'üòî';
                title.innerHTML = '<i class="bi bi-x-circle-fill text-red-600"></i> –≠–∫–∑–∞–º–µ–Ω –Ω–µ —Å–¥–∞–Ω';
                title.className = 'text-3xl font-bold mb-6 text-red-600';
                message.textContent = `–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤—ã –¥–æ–ø—É—Å—Ç–∏–ª–∏ ${wrongCount} ${getErrorsWord(wrongCount)}. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.`;
            }
            
            document.getElementById('correct-answers').textContent = correctCount;
            document.getElementById('wrong-answers').textContent = wrongCount;
            document.getElementById('time-spent').textContent = 
                `${minutes}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('score-percentage').textContent = `${percentage}%`;
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            modal.querySelector('.bg-white').classList.add('scale-100');
        }

        function restartExam() {
            currentQuestion = 0;
            userAnswers = {};
            timeLeft = examData.timeLimit;
            isAnswered = false;
            totalErrors = 0;
            isExamFinished = false;
            
            document.getElementById('result-modal').classList.add('hidden');
            document.getElementById('errors-counter').textContent = '0 –æ—à–∏–±–æ–∫';
            document.getElementById('errors-counter').className = 'flex items-center gap-2 bg-red-50 px-4 py-2 rounded-xl border-2 border-red-200';
            
            displayQuestion(0);
            startTimer();
            updateFinishButton();
        }

        function showMenu() {
            window.location.href = 'index.html';
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ö–ª–∞–≤–∏–∞—Ç—É—Ä–Ω—ã–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è
            document.addEventListener('keydown', (e) => {
                if (isExamFinished) return;
                
                switch(e.key) {
                    case 'ArrowLeft':
                        e.preventDefault();
                        previousQuestion();
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        nextQuestion();
                        break;
                    case '1': case '2': case '3': case '4':
                        if (isAnswered) return;
                        e.preventDefault();
                        const answerIndex = parseInt(e.key) - 1;
                        const question = examData.questions[currentQuestion];
                        if (answerIndex < question.answers.length) {
                            selectAnswer(answerIndex);
                        }
                        break;
                    case 'Escape':
                        if (document.getElementById('result-modal').classList.contains('flex')) {
                            e.preventDefault();
                            document.getElementById('result-modal').classList.add('hidden');
                        }
                        break;
                }
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            document.getElementById('result-modal').addEventListener('click', (e) => {
                if (e.target.id === 'result-modal') {
                    document.getElementById('result-modal').classList.add('hidden');
                }
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
        function updateFinishButton() {
            const finishBtn = document.getElementById('finish-btn');
            const answeredCount = Object.keys(userAnswers).length;
            const totalQuestions = examData.questions.length;
            const allAnswered = answeredCount === totalQuestions;
            
            if (allAnswered) {
                finishBtn.disabled = false;
                finishBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                finishBtn.classList.add('hover:scale-105');
            } else {
                finishBtn.disabled = true;
                finishBtn.classList.add('opacity-50', 'cursor-not-allowed');
                finishBtn.classList.remove('hover:scale-105');
            }
        }

        // –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—å —ç–∫–∑–∞–º–µ–Ω —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
        function tryFinishExam() {
            const answeredCount = Object.keys(userAnswers).length;
            const totalQuestions = examData.questions.length;
            
            if (answeredCount === totalQuestions) {
                finishExam();
            } else {
                showWarningModal(answeredCount, totalQuestions);
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
        function showWarningModal(answeredCount, totalQuestions) {
            document.getElementById('answered-count').textContent = answeredCount;
            document.getElementById('total-count').textContent = totalQuestions;
            
            const modal = document.getElementById('warning-modal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            modal.querySelector('.bg-white').classList.add('scale-100');
        }

        // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
        function closeWarningModal() {
            const modal = document.getElementById('warning-modal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω–∞
        function forceFinishExam() {
            closeWarningModal();
            finishExam();
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', initExam);
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
        document.getElementById('warning-modal').addEventListener('click', (e) => {
            if (e.target.id === 'warning-modal') {
                closeWarningModal();
            }
        });
    </script>
</body>
</html>